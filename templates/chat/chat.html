<h2>Discussion avec {{ target_user.username }}</h2>
<div id="chat-box"></div>
<input type="text" id="message-input" placeholder="Message...">
<button onclick="sendMessage()">Envoyer</button>

<script>
    const username = "{{ request.user.username }}"
    const receiver = "{{ target_user.username }}"
    const socket = new WebSocket('ws://' + window.location.host + '/ws/chat/' + receiver + '/');

    socket.onmessage = function(e) {
        const data = JSON.parse(e.data);
        document.getElementById("chat-box").innerHTML += `<p><strong>${data.sender}:</strong> ${data.message}</p>`;
    };

    function sendMessage() {
        const message = document.getElementById("message-input").value;
        socket.send(JSON.stringify({
            'receiver': receiver,
            'message': message
        }));
        document.getElementById("message-input").value = '';
    }
</script>
